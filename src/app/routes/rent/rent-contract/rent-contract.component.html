<div nz-row [nzGutter]="32">
    <div nz-col [nzMd]="24">
        <nz-card [nzBordered]="false">
            <form class="search-form">
                <div nz-row [nzGutter]="32">
                    <div nz-col [nzMd]="8">
                        <nz-form-item class="form-item">
                            <nz-form-label>用户单位</nz-form-label>
                            <nz-form-control>
                                <nz-select [(ngModel)]="params.renterId" [ngModelOptions]="{standalone: true}" nzPlaceHolder="请选择" nzAllowClear>
                                    <nz-option *ngFor="let opt of rentRenters" [nzValue]="opt.id" [nzLabel]="opt.name"></nz-option>
                                </nz-select>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzMd]="8">
                        <nz-form-item class="form-item">
                            <nz-form-label>地址</nz-form-label>
                            <nz-form-control>
                                <input name="location" nz-input placeholder="请输入" [(ngModel)]="params.location">
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzMd]="8">
                        <div class="form-button">
                            <button nz-button nzType="primary" (click)="findAllByParam()" [nzLoading]="false">
                                查询
                            </button>
                        </div>
                    </div>
                </div>
            </form>
            <div class="button-group">
                <button *ngIf="perms.save" nz-button nzType="primary"
                        (click)="showSave()">
                    <i nz-icon [nzType]="'plus'" [nzTheme]="'outline'"></i>新增
                </button>
            </div>
            <nz-table
                #rowSelectionTable
                nzShowSizeChanger
                [nzFrontPagination]="false"
                [nzData]="tableData"
                [nzLoading]="loading"
                [nzTotal]="total"
                [(nzPageIndex)]="pageNum"
                [(nzPageSize)]="pageSize"
                (nzPageIndexChange)="findAllByParam()"
                (nzPageSizeChange)="findAllByParam()">
                <thead>
                <tr>
                    <th>承租单位名称</th>
                    <th nzShowSort [(nzSortOrder)]="sortMap.location" (nzSortChange)="sort('location', $event)">施工地</th>
                    <th nzShowSort [(nzSortOrder)]="sortMap.location" (nzSortChange)="sort('contacts', $event)">业务员</th>
                    <th nzShowSort [(nzSortOrder)]="sortMap.location" (nzSortChange)="sort('signDate', $event)">签订日期</th>
                    <th>计算方式</th>
                    <th>状态</th>
                    <th nzShowSort [(nzSortOrder)]="sortMap.location" (nzSortChange)="sort('balanceDate', $event)">结算日期</th>
                    <th nzShowSort [(nzSortOrder)]="sortMap.createTime" (nzSortChange)="sort('createTime', $event)">
                        <span>添加时间</span>
                    </th>
                    <th *ngIf="perms.update || perms.delete"><span>操作</span></th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let data of tableData">
                    <td>{{rentRenterMap[data.renterId]}}</td>
                    <td>{{data.location}}</td>
                    <td>{{data.contacts}}</td>
                    <td>{{data.signDate}}</td>
                    <td>
                        <span *ngIf="data.computeMode == global.COMPUTE_MODE_ALL">算头又算尾</span>
                        <span *ngIf="data.computeMode == global.COMPUTE_MODE_START">算头不算尾</span>
                    </td>
                    <td>
                        <span *ngIf="data.contractStatus == global.CONTRACT_OPEN">
                            <nz-badge nzStatus="processing"></nz-badge>租赁中
                        </span>
                        <span *ngIf="data.contractStatus == global.CONTRACT_CLOSE">
                            <nz-badge nzStatus="success"></nz-badge>已结算
                        </span>
                    </td>
                    <td>{{data.balanceDate}}</td>
                    <td>{{data.createTime}}</td>
                    <td *ngIf="perms.update || perms.delete">
                        <a *ngIf="perms.update" (click)="showUpdate(data.id)">修改</a>
                        <nz-divider *ngIf="perms.update && perms.delete" nzType="vertical"></nz-divider>
                        <a *ngIf="perms.delete"
                           nz-popconfirm
                           [nzPopconfirmTitle]="global.DELETE_CONFIRM_MSG"
                           (nzOnConfirm)="confirmDelete(data.id)"
                           (nzOnCancel)="cancelDelete()"
                           nzPopconfirmPlacement="topRight">删除</a>
                    </td>
                </tr>
                </tbody>
            </nz-table>
        </nz-card>
    </div>
</div>
